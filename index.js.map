{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport const BASE_URL = \"https://pixabay.com/\";\nexport const API_KEY = \"46035162-73af77dc9f391d36c3be30780\";\n\nexport let pageNumber = 1;\nexport let perPage = 15; \n\n\nexport async function queryFunction (query, pageNumber) {\nconst options = {\n  key: API_KEY,\n  q: query,\n  image_type: \"photo\",\n  orientation: \"horizontal\",\n  safesearch: \"true\",\n  page: pageNumber,\n  per_page: perPage,\n};\n\nconst params = new URLSearchParams(options);\n\ntry {\nconst response = await axios.get(`${BASE_URL}api/?${params}`)\n    console.log(response.data);\n    return response.data;\n  }\n  catch (error) {\nconsole.error(error);\nthrow error;\n  }\n}\n\n","export const createGalleryMarkup = photos => \n    photos.map(photo => \n        `<li class=\"li-gallery\">\n      <div class=\"img-box\">\n    <a class=\"gallery-link\" href=\"${photo.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${photo.webformatURL}\"\n          alt=\"${photo.tags}\"\n          title=\"${photo.tags}\"/>\n      </a>\n      </div>\n      <div class=\"description-box\">\n        <div class=\"param-boxes\"><p class=\"parameters\">likes</p>\n        <p class=\"values\">${photo.likes}</p></div>\n        <div class=\"param-boxes\"><p class=\"parameters\">views</p>\n        <p class=\"values\">${photo.views}</p></div>\n        <div class=\"param-boxes\"><p class=\"parameters\">comments</p>\n        <p class=\"values\">${photo.comments}</p></div>\n        <div class=\"param-boxes\"><p class=\"parameters\">downloads</p>\n        <p class=\"values\">${photo.downloads}</p></div>\n      </div>\n      </li>`).join(\"\");\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { perPage, queryFunction } from \"./js/pixabay-api\";\nimport { createGalleryMarkup } from \"./js/render-functions\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport iziToast from \"izitoast\";\n\nconst form = document.querySelector('form.js-search-form');\nconst gallery = document.querySelector('.gallery');\nconst btnMore = document.querySelector('button.btn-more');\nlet query = null;\nlet pageNumber = 1;\n\nconst showBox = new SimpleLightbox('.img-box a', { \n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n    overlayOpacity: 0.7,\n    className: 'lightbox',\n   });\n\n function showLoader() {\n    document.getElementById('loader').style.display = 'block';\n    }\n    \n function hideLoader() {\n        document.getElementById('loader').style.display = 'none';\n    }\n\n async function onButtonSubmit (event) {\n        event.preventDefault();\n        pageNumber = 1;\n        showLoader();\n    \n    const forma = event.currentTarget;\n    const {\n        searchValue: { value},\n      } = forma.elements;\n      query = value;\n    console.log(query);\n   \n    if (query === \"\") {\n        iziToast.show({\n            message: `⚠️ Please fill search input`,\n            position: 'topRight',\n            color: 'yellow',\n        })\n         hideLoader();\n    return\n    }\n     \n    gallery.innerHTML = \"\";  \n    \n    await queryFunction(query)\n      .then((photos) => {\n        if(!photos.hits || photos.hits.length === 0) {\n            iziToast.show({\n                title: \"❌\",\n                message: `\"Sorry, there are no images matching your search query. Please try again!\"`,\n                position: 'topRight',\n                color: 'red',\n            })\n            return\n        }\n        console.log(photos);\n        gallery.insertAdjacentHTML(\"beforeend\", createGalleryMarkup(photos.hits));\n        showBox.refresh();\n        btnMore.style.display = \"block\";\n        return query;\n    })\n          \n      .catch((error) => console.log(error))\n      .finally(() => {hideLoader()}); \n    }\n\n\n    \n    async function btnMoreClick () {\n      \n      try {\n        showLoader();\n        pageNumber += 1;\n    const photos = await queryFunction(query, pageNumber);\n      console.log(pageNumber);\n      let totalPages = Math.ceil(photos.totalHits / perPage)\n      console.log(totalPages);\n\n      if (pageNumber >= totalPages) {\n        btnMore.style.display = \"none\";\n        iziToast.show({\n          title: \"❌\",\n          message: `\"We're sorry, but you've reached the end of search results.\"`,\n          position: 'bottomCenter',\n          color: 'blue',\n      })\n      }\n      gallery.insertAdjacentHTML(\"beforeend\", createGalleryMarkup(photos.hits));\n      handleScrollView();\n      showBox.refresh();\n          } catch (error) {\n            console.log(error);\n          } finally { hideLoader();\n          }     \n    }\n\n    function handleScrollView () {\n      const lastArticle = gallery.lastElementChild;\n      const articleHeight = lastArticle.getBoundingClientRect().height;\n      const scrollHeight = articleHeight * 2;\n      \n      window.scrollBy({\n        top: scrollHeight,\n        left: 0,\n        behavior: 'smooth',\n      })\n    }\n\nbtnMore.addEventListener('click', btnMoreClick)\nform.addEventListener('submit', onButtonSubmit);\n\n"],"names":["BASE_URL","API_KEY","perPage","queryFunction","query","pageNumber","options","params","response","axios","error","createGalleryMarkup","photos","photo","form","gallery","btnMore","showBox","SimpleLightbox","showLoader","hideLoader","onButtonSubmit","event","forma","value","iziToast","btnMoreClick","totalPages","handleScrollView","scrollHeight"],"mappings":"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"}